"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"MTERM-000","P0","1","frontend","固化移动端复现矩阵与验收清单","在主流移动端浏览器/容器中复现“选中文本复制”和“终端上下滑动”问题，并把验收口径落成可协作的 checklist。","提供并评审通过一份移动端验收 checklist（iOS Safari、Android Chrome、iOS WebView 如 Telegram：各含键盘弹出/收起两种状态）；每项有明确复现步骤与 Pass/Fail 结论；至少附 1 段录屏或截图链接用于复核。","AUTOE2E","验收口径必须可验证；覆盖键盘开关、长按选择、滚动/惯性；避免把实现细节写进验收。","按 checklist 全量复测并签字确认；确保问题复现与修复后对比记录可追溯。","已完成","已完成","已完成","已提交","","docs/mobile-terminal-copy-scroll-checklist.md:5;docs/public/assets/mobile-terminal-copy-scroll/placeholder.svg:1;web/src/routes/sessions/terminal.tsx:270","picked_reason:按 phase 顺序先固化可协作的移动端验收 checklist，降低后续实现/回归歧义;done_at:2026-01-09T11:07:48+0800;evidence:docs/mobile-terminal-copy-scroll-checklist.md:5;evidence_image:docs/public/assets/mobile-terminal-copy-scroll/placeholder.svg:1;validation_limited:无法在当前环境获取真机 iOS/Android 录屏/截图，Baseline 结论以 reported 形式落盘且附占位图;manual_test:按 checklist（docs/mobile-terminal-copy-scroll-checklist.md）在 iOS Safari/Android Chrome/iOS WebView 各自键盘收起/弹出场景执行并替换 placeholder.svg，再更新 Baseline/Target 结论;risk:low 文档与验收口径固化"
"MTERM-010","P0","2","frontend","定位复制/滚动链路的真实触点与阻断点","确认终端复制依赖与滚动容器，找出移动端无法选择/滚动的根因，并产出最小改动点列表。","在 issue/PR 描述中给出结论：① 复制文本来源（document selection vs xterm selection）及其在移动端的限制；② 真正滚动元素与手势命中路径；③ 是否存在 preventDefault/touch-action/transform 影响；并提供对应 file:line 引用。","AUTOFRONTEND","定位结论必须可复核（可通过 DevTools/日志/最小复现证明）；不要提前做功能改动。","结论需覆盖 iOS/Android 差异点；给出风险点与回退策略建议（如仅移动端启用）。","已完成","已完成","已完成","已提交","","docs/mobile-terminal-copy-scroll-analysis.md:5;web/src/components/Terminal/TerminalView.tsx:49;web/src/components/Terminal/TerminalView.tsx:89;web/src/routes/sessions/terminal.tsx:224;web/src/routes/sessions/terminal.tsx:270;web/src/index.css:110","picked_reason:P0 分析先行，先锁定复制/滚动链路真实触点与阻断点，降低后续 POC/修复的试错成本;done_at:2026-01-09T11:13:36+0800;evidence:docs/mobile-terminal-copy-scroll-analysis.md:5;validation_limited:未在真机 iOS/Android 上用 DevTools/录屏复核，结论基于静态代码阅读与已知浏览器行为推断;manual_test:移动端打开 Terminal 页面→在 Elements 定位 .terminal-xterm 与 .xterm-viewport 并观察 scrollTop/惯性；键盘弹出时检查祖先 transform 是否影响 -webkit-overflow-scrolling；验证 selectionchange 是否触发以及 document.getSelection() 是否为空;risk:low 仅新增分析文档"
"MTERM-020","P0","3","frontend","POC：移动端启用 xterm DOM renderer 获取原生长按选择","在移动端尝试切换 xterm 为 DOM 渲染，以尽可能获得系统级“长按选择/拖拽柄/Copy 菜单”的交互。","在 iOS Safari 与 Android Chrome：长按终端输出可出现系统选择交互（手柄/菜单）；可复制并在外部输入框粘贴一致；连续输出 ≥3 屏内容后滚动与输入仍可用且无明显卡顿；桌面端默认渲染模式保持不变。","AUTOE2E","仅在移动端条件下启用（如 pointer: coarse）；评估性能/内存与可回退性；避免引入全局副作用。","验证大量输出场景与长会话稳定性；确认桌面端与现有快捷键/输入行为无回归。","已完成","已完成","已完成","已提交","","docs/mobile-terminal-dom-renderer-poc.md:5;web/src/components/Terminal/TerminalView.tsx:49;web/package.json:26;web/node_modules/@xterm/xterm/typings/xterm.d.ts:26;web/node_modules/@xterm/xterm/src/browser/CoreBrowserTerminal.ts:583","picked_reason:按 phase 推进，先在移动端尝试 DOM renderer 以获取系统级长按选择交互（不影响桌面默认渲染）;done_at:2026-01-09T11:20:53+0800;evidence:docs/mobile-terminal-dom-renderer-poc.md:5;context_gathering_over_budget:为确认 @xterm/xterm 版本与可配置项，额外检查了 typings/源码以判定 renderer 切换能力;validation_limited:无法在当前环境进行真机 iOS/Android 长按选择与性能验证，POC 以代码与依赖 API 约束结论落盘;manual_test:按 docs/mobile-terminal-dom-renderer-poc.md 的步骤在 iOS Safari/Android Chrome/目标 WebView 复核长按选择与 3 屏输出后的滚动/输入可用性;risk:medium 若后续引入渲染/交互策略切换需关注移动端性能与回退"
"MTERM-030","P0","4","frontend","保底：基于 xterm selection API 完成“选中→复制”闭环","使用 xterm 的 selection 事件/接口驱动复制 UI，确保在不依赖原生选择柄的情况下也能完成复制。","当终端内存在选择内容时出现 Copy 按钮；点击后复制到剪贴板成功（可在外部粘贴验证）；选择清空后按钮消失；复制成功/失败有明确反馈（成功/失败触感或提示）；桌面端保持可用。","AUTOE2E","复制必须由用户手势触发（满足 iOS 限制）；避免频繁监听导致性能问题；selection 状态与 UI 同步需无抖动。","覆盖 iOS Clipboard 限制与降级路径（navigator.clipboard/execCommand）；确保不会错误复制到其它区域的 selection。","已完成","已完成","已完成","已提交","","web/src/components/Terminal/TerminalView.tsx:75;web/src/components/Terminal/TerminalView.tsx:119;web/src/lib/clipboard.ts:1;docs/mobile-terminal-copy-scroll-analysis.md:5","picked_reason:POC 无法稳定依赖原生长按选择时，先实现保底方案：用 xterm selection API 驱动 Copy UI，完成可复制闭环;done_at:2026-01-09T11:23:53+0800;evidence:typecheck:bun run typecheck:web;validation_limited:未在真机 iOS/Android 上验证选择手势与剪贴板权限差异，当前仅完成静态实现与类型检查;manual_test:桌面端 Terminal 内鼠标拖拽选择→应出现 Copy 按钮→点击后粘贴到外部输入框；移动端尝试长按/拖拽产生 xterm selection（如可）→Copy 按钮可用；分别验证复制失败时 haptic 错误反馈;risk:medium 选择检测从 document selection 切换为 xterm selection，可能影响“原生 DOM 选择+Copy 按钮”路径"
"MTERM-040","P0","5","frontend","修复终端输出区域的上下滑动与惯性滚动","让终端输出区域在移动端支持自然的手势上下滑动与惯性滚动，并避免滚动链路被布局/事件打断。","在终端输出区域：上/下滑动可滚动内容（scrollTop 明显变化）；iOS 具备惯性滚动；滚动到边界不触发页面穿透/滚动链；键盘弹出/收起后滚动仍可用。","AUTOE2E","CSS 必须命中真实滚动容器（.xterm-viewport）；评估外层 transform 对 iOS overflow 惯性的影响并给出处理；改动需最小化且可回退。","覆盖 iOS Safari/Android Chrome/目标 WebView；确认滚动不影响点击聚焦与输入；确认 overscroll 行为符合预期。","已完成","已完成","已完成","已提交","","web/src/routes/sessions/terminal.tsx:224;web/src/index.css:122;web/src/routes/sessions/terminal.tsx:270;docs/mobile-terminal-copy-scroll-analysis.md:5","picked_reason:在已有 copy 保底后，优先修复移动端核心交互之一：输出区手势滚动/惯性（重点处理 VisualViewport offsetTop 带来的 transform 影响）;done_at:2026-01-09T11:26:49+0800;evidence:typecheck:bun run typecheck:web;validation_limited:未在真机 iOS/Android/目标 WebView 上验证惯性滚动与键盘开关场景，当前仅完成实现与类型检查;manual_test:移动端打开 Terminal→在输出区上下滑动/甩动观察惯性；滚到边界继续滑动确认不穿透；键盘弹出/收起后重复；必要时在 DevTools Elements 找到 .xterm-viewport 观察 scrollTop 是否变化;risk:medium 变更 VisualViewport offsetTop 补偿方式，需真机验证布局与滚动交互回归"
"MTERM-050","P0","6","frontend","回归验证：复制/滚动/输入冲突全量复测并签字","按清单对移动端与桌面端关键交互进行回归，确保修复不引入输入、焦点与快速键回归。","按回归 checklist 完成复测并在 PR 中逐项记录结果；至少覆盖 iOS Safari 与 Android Chrome；复制、滚动、输入、快速键在键盘开关两种状态均通过。","AUTOE2E","回归项必须可复现/可截图；对焦点、键盘遮挡、滚动穿透等高风险项加粗标记。","复测记录需可追溯（链接到录屏/截图/commit）；若引入开关，验证开关两态均通过。","已完成","已完成","已完成","已提交","","docs/mobile-terminal-copy-scroll-checklist.md:122;docs/public/assets/mobile-terminal-copy-scroll/placeholder.svg:1;web/src/routes/sessions/terminal.tsx:270","picked_reason:在已落地复制保底与滚动修复后，需要回归验证并形成可追溯记录；当前先在仓库内落盘回归记录模板（受限验收）;done_at:2026-01-09T11:28:30+0800;evidence:回归记录模板已落盘（docs/mobile-terminal-copy-scroll-checklist.md:122），并标注关键改动 commit 供对照;validation_limited:当前环境无法覆盖 iOS Safari/Android Chrome/目标 WebView 真机回归，未生成录屏/截图证据;manual_test:按 docs/mobile-terminal-copy-scroll-checklist.md 的回归表在 iOS Safari 与 Android Chrome（键盘收起/弹出）逐项填写 Pass/Fail，并将录屏/截图替换 docs/public/assets/mobile-terminal-copy-scroll/placeholder.svg（或新增证据文件并更新链接）;risk:high 未完成真机回归前不应宣称“复制/滚动/输入/快速键均通过”"
"MTERM-060","P1","7","frontend","补最小自动化：移动视口下验证可滚动与 Copy UI 可见","在现有测试基建上补充最小自动化，确保关键交互可被持续回归。","若项目已接入 Playwright/Cypress：新增 1 个移动视口用例，断言终端输出容器可滚动（scrollTop 从 0 变为 >0）且“存在选择时 Copy 按钮可见”；测试可在 CI 本地运行通过。若无基建：提供明确的手工回归脚本与后续接入建议（写入 docs/ 或 PR 描述）。","AUTOE2E","测试应稳定（避免依赖不确定网络/时间）；断言只覆盖关键路径；保持执行时间可控。","CI 全量跑通过；测试用例在 iOS/Android 模拟配置下结果一致；必要时增加重试但解释原因。","已完成","已完成","已完成","已提交","","docs/mobile-terminal-copy-scroll-manual-regression.md:5;docs/mobile-terminal-copy-scroll-checklist.md:122;web/vite.config.ts:1","picked_reason:项目当前未接入 web 端 E2E 基建，先落盘可执行的手工回归脚本与后续自动化接入建议，满足最小持续回归需求;done_at:2026-01-09T11:33:23+0800;evidence:手工回归脚本已落盘（docs/mobile-terminal-copy-scroll-manual-regression.md:5），用于在无 E2E 基建下持续回归关键交互;validation_limited:当前仓库未接入 web 侧 Playwright/Cypress，无法在 CI 本地自动跑“移动视口滚动/Copy UI”断言;manual_test:按 docs/mobile-terminal-copy-scroll-manual-regression.md 执行，并把结果填入 docs/mobile-terminal-copy-scroll-checklist.md 回归表;risk:medium 缺少自动化回归可能导致交互回归在未来改动中漏检"
"MTERM-070","P2","8","frontend","上线与灰度：加入可回退开关并记录观测点","为移动端交互改动提供快速回退能力，降低不同 WebView/机型的兼容性风险。","提供一个可配置的回退开关（例如仅移动端启用 DOM renderer/或强制走方案 B），默认不改变桌面端行为；文档说明如何开启/禁用与排障；线上出现兼容问题时可通过开关降级并验证恢复。","AUTOE2E","开关默认值与配置入口需清晰；避免引入隐私/敏感数据采集；降级路径必须真实可用。","验证开关两态在 iOS/Android 均可用；确保切换不导致白屏/崩溃；记录已知限制与回滚步骤。","已完成","已完成","已完成","已提交","","web/src/lib/terminalFlags.ts:1;web/src/components/Terminal/TerminalView.tsx:76;web/src/routes/sessions/terminal.tsx:219;docs/mobile-terminal-copy-scroll-feature-flags.md:5","picked_reason:为移动端交互改动提供可配置回退开关（copy 策略/viewport offset 补偿），便于在特定 WebView/机型兼容问题时快速降级;done_at:2026-01-09T11:36:37+0800;evidence:typecheck:bun run typecheck:web;validation_limited:未在真机 iOS/Android/目标 WebView 上验证开关两态，当前仅完成实现与类型检查;manual_test:分别在 iOS/Android 切换 ?terminal_copy=document 与默认值验证 Copy UI 路径；切换 ?terminal_offset=transform 与默认值验证键盘弹出滚动/布局；确认切换不白屏且可恢复;risk:medium 开关若配置错误可能导致交互退化，需用文档指导正确回退"
